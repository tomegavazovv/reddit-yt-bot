<!DOCTYPE html>
<html>
	<head>
		<title>Chart.js Bar Chart Example</title>
		<script src="https://cdn.jsdelivr.net/npm/chart.js@4.0.1"></script>
		<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2 "></script>
		<style>
			.container2 {
				width: 800px !important;
				border: 0.5px solid grey;
				border-radius: 3px;
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
			}

			.chart {
				width: 100%;
				display: flex;
				justify-content: center;
				align-items: center;
			}
		</style>
	</head>

	<body>
		<div class="container2">
			<div class="chart">
				<canvas id="myChart2" width="700" height="530px"></canvas>
			</div>
			<div>
				<h2>Main Platform of the Creator:</h2>
			</div>
			<div class="main_platform2">
				<div class="buttons">
					<button class="platform-button2" data-platform="none">None</button>
					<button class="platform-button2" data-platform="youtube">
						YouTube
					</button>
					<button class="platform-button2" data-platform="instagram">
						Instagram
					</button>
					<button class="platform-button2" data-platform="tiktok">
						TikTok
					</button>
				</div>
			</div>
		</div>

		<script>
			var with_columns2 = ['yt_eng_rate', 'ig_eng_rate', 'tiktok_eng_rate']
			var without_columns2 = [
				'wt_yt_engagement_rate',
				'wt_ig_engagement_rate',
				'wt_tt_engagement_rate',
			]

			document.querySelectorAll('.platform-button2').forEach((button) => {
				button.addEventListener('click', function () {
					onButtonChange(this.getAttribute('data-platform'))
				})
			})

			function onButtonChange(platformValue) {
				let data = json2[platformValue]
				let withData = [
					data[with_columns2[0]],
					data[with_columns2[1]],
					data[with_columns2[2]],
				]
				let withoutData = [
					data[without_columns2[0]],
					data[without_columns2[1]],
					data[without_columns2[2]],
				]

				updateChartData2(withData, withoutData)
			}

			function updateChartData2(withData, withoutData) {
				myChart2.data.datasets[0].data = withoutData
				myChart2.data.datasets[1].data = withData
				myChart2.update()
			}

			function onRadioChange2() {
				let checkedPlatform = ''
				for (var i = 0; i < radios2.length; i++) {
					if (radios2[i].checked) {
						checkedPlatform = radios2[i].value
					}
				}
				let data = json2[checkedPlatform]
				let withData = [
					data[with_columns2[0]],
					data[with_columns2[1]],
					data[with_columns2[2]],
				]
				let withoutData = [
					data[without_columns2[0]],
					data[without_columns2[1]],
					data[without_columns2[2]],
				]

				updateChartData2(withData, withoutData)
			}

			var ctx2 = document.getElementById('myChart2').getContext('2d')

			var radios2 = document.querySelectorAll(
				'.main_platform2 input[type="radio"]'
			)

			radios2.forEach(function (radio) {
				radio.addEventListener('change', onRadioChange2)
			})

			var json2 = {
				none: {
					ig_eng_rate: 9.737842605156038,
					yt_eng_rate: 5.753757225433527,
					tiktok_eng_rate: 11.963427299186645,
					count: 2227,
					main_platform: '',
					wt_ig_engagement_rate: 6.348901973482396,
					wt_yt_engagement_rate: 3.94178688415001,
					wt_tt_engagement_rate: 10.680002267639729,
					wcount: 59103,
					ig_increasement: 53.378373864147036,
					yt_increasement: 45.968247257848454,
					tt_increasement: 12.017085758826822,
				},
				youtube: {
					ig_eng_rate: 9.233530450132392,
					yt_eng_rate: 5.386578715919085,
					tiktok_eng_rate: 12.020313763827868,
					count: 1143,
					main_platform: 'YouTube',
					wt_ig_engagement_rate: 7.168163832294998,
					wt_yt_engagement_rate: 3.356967552640663,
					wt_tt_engagement_rate: 8.526994747955674,
					wcount: 11934,
					ig_increasement: 28.813049843144206,
					yt_increasement: 60.45965984037844,
					tt_increasement: 40.96776319358832,
				},
				instagram: {
					ig_eng_rate: 5.279,
					yt_eng_rate: 6.828248847926267,
					tiktok_eng_rate: 11.021825446271995,
					count: 654,
					main_platform: 'Instagram',
					wt_ig_engagement_rate: 4.607142450709835,
					wt_yt_engagement_rate: 4.219947862356621,
					wt_tt_engagement_rate: 8.909318686187536,
					wcount: 35446,
					ig_increasement: 14.582955844715626,
					yt_increasement: 61.8088438683469,
					tt_increasement: 23.711204352354805,
				},
				tiktok: {
					ig_eng_rate: 12.329264705882352,
					yt_eng_rate: 5.576360759493671,
					tiktok_eng_rate: 15.180386001136904,
					count: 410,
					main_platform: 'TikTok',
					wt_ig_engagement_rate: 10.880498464238702,
					wt_yt_engagement_rate: 4.567458847736625,
					wt_tt_engagement_rate: 13.762503338906708,
					wcount: 11462,
					ig_increasement: 68.459788548528,
					yt_increasement: 22.088910823071796,
					tt_increasement: 21.36982326175297,
				},
			}
			Chart.register(ChartDataLabels)
			let data2 = json2['none']
			var myChart2 = new Chart(ctx2, {
				type: 'bar',
				data: {
					labels: ['Youtube', 'Instagram', 'TikTok'],
					datasets: [
						{
							label: 'Without Community',
							data: [
								data2[without_columns2[0]],
								data2[without_columns2[1]],
								data2[without_columns2[2]],
							],
							backgroundColor: 'rgba(254,36,90, 0.7)',
						},
						{
							label: 'With Community',
							data: [
								data2[with_columns2[0]],
								data2[with_columns2[1]],
								data2[with_columns2[2]],
							],
							backgroundColor: 'rgba(54, 162, 235, 0.8)',
						},
					],
				},
				options: {
					responsive: true,
					scales: {
						y: {
							beginAtZero: true,
							max: 16,
							grid: {
								display: false,
								color: 'rgba(200, 200, 200, 0.8)', // Lighter grid lines
								borderColor: 'rgba(0, 0, 0, 0.8)', // Darker border color
								borderWidth: 1,
								drawBorder: true,
								drawOnChartArea: true, // Set to false to hide grid lines
								drawTicks: true, // Set to false to hide ticks on grid lines
							},
							title: {
								display: true, // Display the Y-axis title
								text: 'Engagement Rate',
								color: 'grey', // Set the Y-axis title text
								font: {
									size: 17, // Adjust the font size of the Y-axis title
									family: 'Arial',
									weight: '300',
								},
							},
							ticks: {
								font: {
									size: 10,
									family: 'Arial',
									weight: '500',
								},
								color: 'black',
								callback: function (value, index, values) {
									return value + '%'
								},
							},
						},
						x: {
							grid: {
								display: false,
							},
							ticks: {
								color: 'black',

								font: {
									size: 18,
									family: 'Arial',
									weight: '500',
								},
							},
						},
					},
					plugins: {
						datalabels: {
							color: '#737271', // Label text color
							anchor: 'end', // Anchor the label to the end of the bar
							align: 'top', // Align label at the top of the bar
							font: {
								weight: '400',
								family: 'Arial',
								size: 14, // Adjust label font size
							},
							formatter: function (value, context) {
								return value.toFixed(2) + '%' // Format label text
							},
						},
						legend: {
							display: true,
							position: 'top', // can be 'top', 'bottom', 'left', 'right'
							labels: {
								color: 'black', // font color
								font: {
									size: 10, // font size
									family: 'Arial',
									weight: '500', // font family
								},
								boxWidth: 8,
								padding: 20,
							},
						},
						title: {
							display: true,
							text: 'Community Impact On The Engagement Rate',
							color: 'black',
							font: {
								size: 28,
								weight: '500',
								family: 'Arial',
							},
							padding: {
								top: 10,
								bottom: 20,
							},
						},
					},
					elements: {
						bar: {
							borderWidth: 2, // Border width of bars
							borderColor: 'rgba(0, 0, 0, 0.8)', // Border color of bars
							borderRadius: 4, // Rounded corners for bars
							hoverBorderColor: 'rgba(0, 0, 0, 1)', // Hover border color
						},
					},
				},
			})
		</script>
	</body>
</html>
